import{j as c}from"./jsx-runtime-BTJTZTIL.js";import{c as x}from"./index-DUmpqB7p.js";import{r as a}from"./index-CJ_LmFaV.js";import{u as w}from"./index-JZGyZbA2.js";import{T as B}from"./TruncateString-D54BiV_x.js";import{C as R}from"./Counter-DXWSEFY6.js";import{e as j,a as T}from"./componentPropsProcessors-UJEZy8aQ.js";const F={Auto:"auto"},k=(l,t,o)=>o==="xs"?"label-only":l&&t?"icon-before":t?"label-only":"icon-only",H="_segment_186il_1",I="_icon_186il_117",P="_label_186il_123",_={segment:H,icon:I,label:P};function C({size:l,label:t,value:o,selected:s,onClick:v,disabled:m,icon:i,counter:r,focusable:f,onGetFocusable:d,onSelectionUpdated:e,renderWrapSegment:n}){const p=a.useRef(null);a.useEffect(()=>{f&&(d==null||d(p.current))},[f,d]),a.useEffect(()=>{s&&p.current&&e(p.current)},[s,p,e]);const y=c.jsxs("button",{ref:p,"data-test-id":`section-${o}`,"data-active":s||void 0,"data-disabled":m||void 0,"data-layout":k(i,t,l),className:x(_.segment),onClick:v,"data-size":l,disabled:m,tabIndex:f?0:-1,"aria-checked":s,role:"radio",type:"button",children:[l!=="xs"&&i&&c.jsx("div",{className:_.icon,children:i}),t&&c.jsx(B,{className:_.label,"data-size":l,text:t}),r&&c.jsx(R,{...r,size:"s"})]});return n?n(y):y}try{C.displayName="Segment",C.__docgenInfo={description:"",displayName:"Segment",props:{value:{defaultValue:null,description:"Идентификатор сегмента.",name:"value",required:!0,type:{name:"IdType"}},disabled:{defaultValue:null,description:"Состояние активности сегмента.",name:"disabled",required:!1,type:{name:"boolean"}},renderWrapSegment:{defaultValue:null,description:"Render-обертка над сегментом.",name:"renderWrapSegment",required:!1,type:{name:"((segment: ReactNode) => ReactNode)"}},label:{defaultValue:null,description:"Текстовый заголовок сегмента.",name:"label",required:!1,type:{name:"string"}},icon:{defaultValue:null,description:"Иконка сегмента.",name:"icon",required:!1,type:{name:"ReactNode"}},counter:{defaultValue:null,description:"Счетчик сегмента.",name:"counter",required:!1,type:{name:'Omit<CounterProps, "size">'}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'},{value:'"m"'},{value:'"l"'}]}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},focusable:{defaultValue:null,description:"",name:"focusable",required:!1,type:{name:"boolean"}},onGetFocusable:{defaultValue:null,description:"",name:"onGetFocusable",required:!1,type:{name:"((ref: HTMLButtonElement | null) => void)"}},onSelectionUpdated:{defaultValue:null,description:"",name:"onSelectionUpdated",required:!0,type:{name:"(element: HTMLButtonElement) => void"}}}}}catch{}function L({selected:l,items:t}){const[o,s]=a.useState(l),[v,m]=a.useState(!1),{prev:i,next:r}=a.useMemo(()=>t.reduce((e,n)=>(e._isNextSearching&&!e.next&&(e.next=n.disabled?e.next:n.value),o===n.value&&(e._isNextSearching=!0),e._isNextSearching||(e.prev=n.disabled?e.prev:n.value),e),{_isNextSearching:!1}),[o,t]),f=a.useCallback(e=>{switch(e.key){case"ArrowLeft":{i&&(m(!0),s(i));return}case"ArrowRight":{r&&(m(!0),s(r));return}default:return}},[r,i]),d=a.useCallback(e=>{m(n=>(n&&(e==null||e.focus()),!1))},[]);return{onKeyDown:f,focusableSegmentValue:o,onGetFocusable:d}}const z="_container_176hw_1",M="_segmentHolder_176hw_48",O="_selection_176hw_59",D={container:z,segmentHolder:M,selection:O};function V({defaultValue:l,size:t="m",className:o,onChange:s,items:v,value:m,outline:i,width:r=F.Auto,name:f,...d}){const[e,n]=w(m,l,s),{focusableSegmentValue:p,onGetFocusable:y,onKeyDown:h}=L({selected:e,items:v}),E=a.useRef(null),S=a.useRef(),[q,N]=a.useState(),g=a.useCallback((u=S.current)=>{u&&(S.current=u,setTimeout(()=>{N({top:u.offsetTop,left:u.offsetLeft,width:u.offsetWidth,height:u.offsetHeight})}))},[]);a.useEffect(()=>{if(!E.current)return;const u=new ResizeObserver(()=>g());u.observe(E.current);const b=new MutationObserver(()=>g());return b.observe(E.current,{childList:!0}),()=>{u.disconnect(),b.disconnect()}},[g]);const A=a.useMemo(()=>v.map(u=>c.jsx("div",{className:D.segmentHolder,"data-width":r,children:c.jsx(C,{...u,size:t,onGetFocusable:y,selected:e===u.value,onClick:()=>n(u.value),focusable:p===u.value,onSelectionUpdated:g})},u.value)),[v,r,t,y,e,p,g,n]);return c.jsxs("div",{ref:E,"data-size":t,onKeyDown:h,className:x(D.container,o),role:"radiogroup","data-outline":i||void 0,"data-width":r,...T(d),...j(d),children:[f&&c.jsx("input",{type:"hidden",value:e,name:f}),c.jsx("div",{"data-size":t,style:q,className:D.selection,"aria-hidden":!0}),A]})}try{V.displayName="SegmentedControl",V.__docgenInfo={description:"SegmentedControl",displayName:"SegmentedControl",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"Набор сегментов.",name:"items",required:!0,type:{name:"Segment<Value>[]"}},value:{defaultValue:null,description:"Value выбранного сегмента.",name:"value",required:!1,type:{name:"IdType"}},defaultValue:{defaultValue:null,description:"ID выбранного по умолчанию сегмента. (в uncontrolled режиме)",name:"defaultValue",required:!1,type:{name:"IdType"}},onChange:{defaultValue:null,description:"Колбек смены выбранного сегмента.",name:"onChange",required:!1,type:{name:"((value: Value) => void)"}},className:{defaultValue:null,description:"CSS-класс контейнера.",name:"className",required:!1,type:{name:"string"}},size:{defaultValue:{value:"m"},description:"Размер компонента.",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'},{value:'"m"'},{value:'"l"'}]}},outline:{defaultValue:null,description:"Обводка",name:"outline",required:!1,type:{name:"boolean"}},width:{defaultValue:{value:"auto"},description:"Управление шириной компонента.",name:"width",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"full"'}]}},name:{defaultValue:null,description:"Имя поля",name:"name",required:!1,type:{name:"string"}}}}}catch{}export{V as S};
