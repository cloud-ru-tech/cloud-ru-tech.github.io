import{r as u}from"./index-CJ_LmFaV.js";import{i as se}from"./isBrowser-C2N6XvuH.js";var D=(e=>(e.Day="D",e.Month="M",e.Year="Y",e.Hours="h",e.Minutes="m",e.Seconds="s",e))(D||{});const g={Date:"date",DateTime:"date-time"},T={FullTime:"full-time",NoSeconds:"no-seconds"},A="date-time-no-sec",R={[g.Date]:{"ru-RU":"ДД.ММ.ГГГГ","en-US":"DD.MM.YYYY"},[g.DateTime]:{"ru-RU":"ДД.ММ.ГГГГ, чч:мм:сс","en-US":"DD.MM.YYYY, hh:mm:ss"},[A]:{"ru-RU":"ДД.ММ.ГГГГ, чч:мм","en-US":"DD.MM.YYYY, hh:mm"},[T.FullTime]:{"ru-RU":"чч:мм:сс","en-US":"hh:mm:ss"},[T.NoSeconds]:{"ru-RU":"чч:мм","en-US":"hh:mm"}},z=new Intl.Locale("ru-RU"),J={D:{start:0,end:2,max:31,min:1},M:{start:3,end:5,max:12,min:1},Y:{start:6,end:10,max:2100,min:1900}},V=(e,t)=>({h:{start:e,end:e+2,max:23,min:0},m:{start:e+3,end:e+5,max:59,min:0},...t?{s:{start:e+6,end:e+8,max:59,min:0}}:{}}),N={[g.Date]:J,[g.DateTime]:{...J,...V(12,!0)},[A]:{...J,...V(12,!1)},[T.FullTime]:V(0,!0),[T.NoSeconds]:V(0,!1)},Z={[g.Date]:["D","M","Y"],[g.DateTime]:["D","M","Y","h","m","s"],[A]:["D","M","Y","h","m"],[T.FullTime]:["h","m","s"],[T.NoSeconds]:["h","m"]},Q={D:"ДД",M:"ММ",Y:"ГГГГ"},j={h:"чч",m:"мм",s:"сс"},W={D:"DD",M:"MM",Y:"YYYY"},$={h:"hh",m:"mm",s:"ss"},ee={[g.Date]:{"ru-RU":Q,"en-US":W},[g.DateTime]:{"ru-RU":{...Q,...j},"en-US":{...W,...$}},[A]:{"ru-RU":{...Q,...j,s:void 0},"en-US":{...W,...$,s:void 0}},[T.FullTime]:{"ru-RU":j,"en-US":$},[T.NoSeconds]:{"ru-RU":{...j,s:void 0},"en-US":{...$,s:void 0}}};function ce(e){return t=>{if(t!==null){for(const n in N[e])if(t>=N[e][n].start&&t<=N[e][n].end)return n}}}function ae(e){const t=Z[e];return n=>{const m=t.length-1,c=t[m],i=t.indexOf(n);return i===-1||i===m?c:t[i+1]}}function ue(e){const t=Z[e];return n=>{const c=t[0],i=t.indexOf(n);return i===-1||i===0?c:t[i-1]}}const X=new Date;function le(e){if(!e)return;const t=e.split(", "),n=t[0];let m=t[1],[c,i,v]=n.split(".").map(Number);if(i-=1,n.includes(":")&&(m=n),m){(isNaN(v)||isNaN(i)||isNaN(c))&&(v=X.getFullYear(),i=X.getMonth(),c=X.getDay());const[d=0,L=0,f=0]=m.split(":").map(M=>Number(M??0));return new Date(v,i,c,d,L,f)}return new Date(v,i,c)}function oe({inputRef:e,mode:t}){const n=u.useCallback(s=>{if(e.current){const{start:l,end:a}=N[t][s];e.current.setSelectionRange(l,a)}},[t,e]),m=u.useCallback(()=>{var s,l,a;return((s=e.current)==null?void 0:s.value.length)===((l=e.current)==null?void 0:l.selectionEnd)&&((a=e.current)==null?void 0:a.selectionStart)===0},[e]),c=u.useCallback(s=>e.current?e.current.value.slice(N[t][s].start,N[t][s].end):"",[t,e]),i=u.useCallback(()=>e.current?Object.keys(N[t]).every(s=>c(s)&&Number.isInteger(Number(c(s)))):!1,[t,c,e]),v=u.useCallback(()=>{if(Object.values(T).includes(t))return!0;const l=parseInt(c(D.Day),10),a=parseInt(c(D.Month),10),S=parseInt(c(D.Year),10);return!a||!l?!0:new Date(S||2020,a-1,l).getDate()===l},[c,t]),d=u.useCallback(()=>{var C;let s;const l=Object.keys(N[t]).reduce((E,G)=>{const F=G;return E[F]=parseInt(c(F),10),E},{}),{[D.Day]:a,[D.Month]:S,[D.Year]:Y,[D.Hours]:x,[D.Minutes]:w,[D.Seconds]:U}=l,h=N[t][D.Year],_=!!(a&&S&&Y>=(h==null?void 0:h.min)&&Y<=(h==null?void 0:h.max)),k=[x,w,...t===g.DateTime||t===T.FullTime?[U]:[]].every(E=>E!==void 0);if(t===g.DateTime||t===A?s=_&&k:t===T.FullTime||t===T.NoSeconds?s=k:s=_,s&&e.current){const E=(C=e.current)==null?void 0:C.value.length;e.current.selectionStart=E,e.current.selectionEnd=E}return s},[c,e,t]),L=u.useCallback((s,l)=>{if(e.current){const{start:a,end:S,max:Y}=N[t][s];e.current.value=e.current.value.slice(0,a)+l.toString().padStart(Y.toString().length,"0")+e.current.value.slice(S),n(s)}},[e,n,t]),f=u.useMemo(()=>ae(t),[t]),M=u.useMemo(()=>ue(t),[t]),b=u.useMemo(()=>ce(t),[t]),I=u.useCallback(s=>{const l=le(s);return l&&(t===T.FullTime||t===T.NoSeconds)?{hours:l.getHours(),minutes:l.getMinutes(),seconds:l.getSeconds()}:l},[t]);return{isAllSelected:m,isValidInput:v,tryToCompleteInput:d,getSlot:c,updateSlot:L,setFocus:n,isLikeDate:i,getNextSlotKey:f,getPrevSlotKey:M,getSlotKeyFromIndex:b,parseDate:I}}function me({inputRef:e,onChange:t,readonly:n,locale:m=z,setIsOpen:c,mode:i,showSeconds:v}){var K;const d=i===g.DateTime&&!v?A:i,L=N[d],f=R[d][m.baseName]||R[d][z.baseName],M=ee[d][m.baseName]||ee[d][z.baseName],b=Z[d],{getNextSlotKey:I,getPrevSlotKey:s,getSlotKeyFromIndex:l,setFocus:a,updateSlot:S,getSlot:Y,isLikeDate:x,isAllSelected:w,tryToCompleteInput:U,isValidInput:h,parseDate:_}=oe({inputRef:e,mode:d}),k=u.useMemo(()=>b[0],[b]),C=u.useRef(k),E=u.useCallback(r=>{if(!e.current||n)return;if(se()&&document.activeElement!==e.current){C.current=r||k,e.current.focus();return}const P=r||C.current;if(x()&&P===k)return;if(!e.current.value){e.current.value=f,a(k);return}if(r!=="auto"){a(P);return}const o=l(e.current.selectionStart);if(o){const{start:q,end:O}=L[o];e.current.setSelectionRange(q,O)}},[e,n,x,k,l,f,a,L]),G=u.useCallback(()=>{E("auto")},[E]),F=()=>{var r;t&&x()&&t(_(((r=e.current)==null?void 0:r.value)||""))},H=u.useCallback(r=>{if(!(r===b[b.length-1]&&U())){if(h()){a(I(r));return}switch(r){case D.Day:S(D.Month,(M==null?void 0:M[D.Month])??""),a(D.Month);return;case D.Year:case D.Month:S(D.Day,(M==null?void 0:M[D.Day])??""),a(D.Day);return;default:a(I(r))}}},[b,U,h,a,I,S,M]),te=u.useCallback(r=>{if(e.current&&!n){if(r.key!=="Tab"&&(r.preventDefault(),r.stopPropagation()),r.key!=="ArrowDown"&&c(!1),r.key==="Escape"){e.current.blur();return}r.key==="Enter"&&U();const P=e.current.selectionStart,o=l(P);if(o){const q=Y(o),{max:O}=L[o],ne=Number(q)||0;if(r.key==="ArrowRight"){if(w()||o===b[b.length-1]){e.current.selectionStart=e.current.value.length;return}a(I(o));return}if(r.key==="ArrowLeft"){a(s(o));return}if(r.key==="Backspace"&&(w()?(e.current.value=f,a(k)):S(o,M[o]??"")),/^\d+$/.test(r.key)){const y=parseInt(ne.toString()+r.key,10)||0,p=y.toString().length,B=O.toString().length;p<B?(y&&S(o,y),y*10>O&&H(o)):p>B?Number(r.key)*10>O?(S(o,r.key),H(o)):Number(r.key)&&S(o,r.key):y<=O?(S(o,y),H(o)):Number(r.key)*10>O?(S(o,r.key),H(o)):Number(r.key)&&S(o,r.key)}t==null||t(_(x()?e.current.value:""))}}},[e,n,l,c,U,Y,L,_,x,t,w,b,a,I,s,f,k,S,M,H]),re=u.useCallback(()=>{var r;!n&&((r=e.current)==null?void 0:r.value)===f&&(e.current.value=""),C.current=k},[e,f,n,k]);return{handleKeyDown:te,handleChange:F,handleClick:G,setInputFocus:E,value:(K=e.current)==null?void 0:K.value,mask:f,handleBlur:re}}function Se({onFocusByKeyboard:e,onFocusByClick:t}){const n=u.useRef(!1),m=u.useRef(!1),c=u.useCallback(d=>{n.current=!0,m.current?(t==null||t(d),m.current=!1):e==null||e(d)},[m,t,e]),i=u.useCallback(()=>{n.current=!1,m.current=!1},[]),v=u.useCallback(()=>{n.current||(m.current=!0)},[n]);return{onFocus:c,onBlur:i,onMouseDown:v}}function de(e){return u.useCallback(t=>{e.forEach(n=>n==null?void 0:n(t))},[e])}export{z as D,D as S,T,de as a,Se as b,me as u};
